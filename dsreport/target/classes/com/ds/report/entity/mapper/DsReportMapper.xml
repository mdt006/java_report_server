<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.ds.report.dao.mapper.DsReportMapper" >
  <resultMap id="BaseResultMap" type="com.ds.report.entity.DsReport" >
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="username" property="username" jdbcType="VARCHAR" />
    <result column="bet_count" property="betCount" jdbcType="INTEGER" />
    <result column="betamount" property="betamount" jdbcType="DECIMAL" />
    <result column="winlose" property="winlose" jdbcType="DECIMAL" />
    <result column="validamount" property="validamount" jdbcType="DECIMAL" />
    <result column="site_id" property="siteId" jdbcType="INTEGER" />
    <result column="live_id" property="liveId" jdbcType="TINYINT" />
    <result column="live_name" property="liveName" jdbcType="VARCHAR" />
    <result column="game_kind" property="gameKind" jdbcType="INTEGER" />
    <result column="game_kind_name" property="gameKindName" jdbcType="VARCHAR" />
    <result column="game_type" property="gameType" jdbcType="INTEGER" />
    <result column="game_name" property="gameName" jdbcType="VARCHAR" />
    <result column="bet_time" property="betTime" jdbcType="DATE" />
    <result column="agents" property="agents" jdbcType="VARCHAR" />
    <result column="world" property="world" jdbcType="VARCHAR" />
    <result column="corprator" property="corprator" jdbcType="VARCHAR" />
    <result column="superior" property="superior" jdbcType="VARCHAR" />
    <result column="company" property="company" jdbcType="VARCHAR" />
    <result column="comm_agent" property="commAgent" jdbcType="DECIMAL" />
    <result column="comm_world" property="commWorld" jdbcType="DECIMAL" />
    <result column="comm_corprator" property="commCorprator" jdbcType="DECIMAL" />
    <result column="comm_superior" property="commSuperior" jdbcType="DECIMAL" />
    <result column="comm_branch" property="commBranch" jdbcType="DECIMAL" />
  </resultMap>
  <resultMap id="ReportResultMap" type="com.ds.report.entity.DsReport" >
    <result column="username" property="username" jdbcType="VARCHAR" />
    <result column="bet_count" property="betCount" jdbcType="INTEGER" />
    <result column="betamount" property="betamount" jdbcType="DECIMAL" />
    <result column="winlose" property="winlose" jdbcType="DECIMAL" />
    <result column="validamount" property="validamount" jdbcType="DECIMAL" />
    <result column="site_id" property="siteId" jdbcType="INTEGER" />
    <result column="game_kind" property="gameKind" jdbcType="INTEGER" />
    <result column="game_kind_name" property="gameKindName" jdbcType="VARCHAR" />
    <result column="agents" property="agents" jdbcType="VARCHAR" />
    <result column="world" property="world" jdbcType="VARCHAR" />
    <result column="corprator" property="corprator" jdbcType="VARCHAR" />
    <result column="superior" property="superior" jdbcType="VARCHAR" />
    <result column="company" property="company" jdbcType="VARCHAR" />
    <result column="comm_agent" property="commAgent" jdbcType="DECIMAL" />
    <result column="comm_world" property="commWorld" jdbcType="DECIMAL" />
    <result column="comm_corprator" property="commCorprator" jdbcType="DECIMAL" />
    <result column="comm_superior" property="commSuperior" jdbcType="DECIMAL" />
    <result column="comm_branch" property="commBranch" jdbcType="DECIMAL" />
  </resultMap>
  <resultMap id="BetTotalMap" type="com.ds.report.entity.DsReport" >
    <result column="game_kind" property="gameKind" jdbcType="INTEGER" />
    <result column="game_kind_name" property="gameKindName" jdbcType="VARCHAR" />
   	<result column="game_type" property="gameType" jdbcType="INTEGER" />
    <result column="game_name" property="gameName" jdbcType="VARCHAR" />
    <result column="bet_time" property="betTime" jdbcType="DATE" />
    <result column="bet_count" property="betCount" jdbcType="INTEGER" />
    <result column="betamount" property="betamount" jdbcType="DECIMAL" />
    <result column="winlose" property="winlose" jdbcType="DECIMAL" />
    <result column="validamount" property="validamount" jdbcType="DECIMAL" />
  </resultMap>
  <resultMap id="PrivilegeTotalMap" type="com.ds.report.entity.DsPrivilegeTotal" >
  	<result column="username" property="username" jdbcType="VARCHAR" />
  	<result column="bb_sport_validamount" property="bbSportValidamount" jdbcType="DECIMAL" />
  	<result column="bb_live_validamount" property="bbLiveValidamount" jdbcType="DECIMAL" />
  	<result column="bb_jilv_validamount" property="bbJilvValidamount" jdbcType="DECIMAL" />
  	<result column="bb_3d_validamount" property="bb3dValidamount" jdbcType="DECIMAL" />
  	<result column="ag_live_validamount" property="agLiveValidamount" jdbcType="DECIMAL" />
  	<result column="ag_jilv_validamount" property="agJilvValidamount" jdbcType="DECIMAL" />
  	<result column="ds_live_validamount" property="dsLiveValidamount" jdbcType="DECIMAL" />
  	<result column="lotto_validamount" property="lottoValidamount" jdbcType="DECIMAL" />
  	<result column="hongkong_validamount" property="hongkongValidamount" jdbcType="DECIMAL" />
  	<!-- 新增幸运彩,将经典彩彩拆分成经典时时彩以及经典香港彩 -->
  	<result column="xingyun_validamount" property="xingyunValidamount" jdbcType="DECIMAL" />
  	<result column="jingdianshishicai_validamount" property="jingdianshishicaiValidamount" jdbcType="DECIMAL" />
  	<result column="jingdianxianggangcai_validamount" property="jingdianxianggangValidamount" jdbcType="DECIMAL" />
  </resultMap>
  <resultMap id="CommissionTotalMap" type="com.ds.report.entity.DsCommissionTotal" >
    <result column="agents" property="agents" jdbcType="VARCHAR" />
    <result column="user_count" property="userCount" jdbcType="INTEGER" />
    <result column="winlose" property="winlose" jdbcType="DECIMAL" />
    <result column="validamount" property="validamount" jdbcType="DECIMAL" />
  </resultMap>
   <resultMap id="AuditTotalMap" type="com.ds.report.entity.DsAuditTotal" >
  	<result column="username" property="username" jdbcType="VARCHAR" />
  	<result column="sport_validamount" property="sportValidamount" jdbcType="DECIMAL" />
  	<result column="live_validamount" property="liveValidamount" jdbcType="DECIMAL" />
  	<result column="jilv_validamount" property="jilvValidamount" jdbcType="DECIMAL" />
  	<result column="lotto_validamount" property="lottoValidamount" jdbcType="DECIMAL" />
  	<result column="total_validamount" property="totalValidamount" jdbcType="DECIMAL" />
  	
  </resultMap>
  <!-- <resultMap id="WaterTotalMap" type="com.ds.report.entity.DsWaterTotal" >
  	<result column="agents" property="agents" jdbcType="VARCHAR" />
  	<result column="username" property="username" jdbcType="VARCHAR" />
  	<result column="total_validamount" property="totalValidamount" jdbcType="DECIMAL" />
  	<result column="total_water" property="totalWater" jdbcType="DECIMAL" />
  	<result column="return_water" property="returnWater" jdbcType="DECIMAL" />
  	<result column="ball_validamount" property="ballValidamount" jdbcType="DECIMAL" />
  	<result column="ball_water" property="ballWater" jdbcType="DECIMAL" />
	<result column="live_validamount" property="liveValidamount" jdbcType="DECIMAL" />
  	<result column="live_water" property="liveWater" jdbcType="DECIMAL" />
  	<result column="live_bb_validamount" property="liveBbValidamount" jdbcType="DECIMAL" />
  	<result column="live_bb_water" property="liveBbWater" jdbcType="DECIMAL" />
  	<result column="live_ds_validamount" property="liveDsValidamount" jdbcType="DECIMAL" />
  	<result column="live_ds_water" property="liveDsWater" jdbcType="DECIMAL" />
  	<result column="live_other_validamount" property="liveOtherValidamount" jdbcType="DECIMAL" />
  	<result column="live_other_water" property="liveOtherWater" jdbcType="DECIMAL" />
  	<result column="game_validamount" property="gameValidamount" jdbcType="DECIMAL" />
  	<result column="game_water" property="gameWater" jdbcType="DECIMAL" />
  	<result column="lotto_validamount" property="lottoValidamount" jdbcType="DECIMAL" />
  	<result column="lotto_water" property="lottoWater" jdbcType="DECIMAL" />
  	<result column="hongkong_validamount" property="hongkongValidamount" jdbcType="DECIMAL" />
  	<result column="hongkong_water" property="hongkongWater" jdbcType="DECIMAL" />
  	<result column="bb_sport_validamount" property="bbSportValidamount" jdbcType="DECIMAL" />
  	<result column="bb_sport_water" property="bbSportWater" jdbcType="DECIMAL" />
  	<result column="bb_3d_validamount" property="bb3dValidamount" jdbcType="DECIMAL" />
  	<result column="bb_3d_water" property="bb3dWater" jdbcType="DECIMAL" />
  </resultMap>-->
  
  <resultMap id="WaterTotalMap" type="com.ds.report.entity.DsWaterTotal" >
  	<result column="agents" property="agents" jdbcType="VARCHAR" />
  	<result column="username" property="username" jdbcType="VARCHAR" />
  	<result column="total_validamount" property="totalValidamount" jdbcType="DECIMAL" />
  	<result column="total_calc_validamount" property="totalCalcValidamount" jdbcType="DECIMAL" />
  	<result column="total_uncalc_validamount" property="totalUncalcValidamount" jdbcType="DECIMAL" />
  	<result column="total_water" property="totalWater" jdbcType="DECIMAL" />
  	<result column="return_water" property="returnWater" jdbcType="DECIMAL" />
  	<result column="ball_validamount" property="ballValidamount" jdbcType="DECIMAL" />
  	<result column="ball_calc_validamount" property="ballCalcValidamount" jdbcType="DECIMAL" />
  	<result column="ball_uncalc_validamount" property="ballUncalcValidamount" jdbcType="DECIMAL" />
  	<result column="ball_water" property="ballWater" jdbcType="DECIMAL" />
	<result column="live_validamount" property="liveValidamount" jdbcType="DECIMAL" />
  	<result column="live_water" property="liveWater" jdbcType="DECIMAL" />
  	<result column="live_bb_validamount" property="liveBbValidamount" jdbcType="DECIMAL" />
  	<result column="live_bb_calc_validamount" property="liveBbCalcValidamount" jdbcType="DECIMAL" />
  	<result column="live_bb_uncalc_validamount" property="liveBbUncalcValidamount" jdbcType="DECIMAL" />
  	<result column="live_bb_water" property="liveBbWater" jdbcType="DECIMAL" />
  	<result column="live_ds_validamount" property="liveDsValidamount" jdbcType="DECIMAL" />
  	<result column="live_ds_calc_validamount" property="liveDsCalcValidamount" jdbcType="DECIMAL" />
  	<result column="live_ds_uncalc_validamount" property="liveDsUncalcValidamount" jdbcType="DECIMAL" />
  	<result column="live_ds_water" property="liveDsWater" jdbcType="DECIMAL" />
  	<result column="live_other_validamount" property="liveOtherValidamount" jdbcType="DECIMAL" />
  	<result column="live_other_calc_validamount" property="liveOtherCalcValidamount" jdbcType="DECIMAL" />
  	<result column="live_other_uncalc_validamount" property="liveOtherUncalcValidamount" jdbcType="DECIMAL" />
  	<result column="live_other_water" property="liveOtherWater" jdbcType="DECIMAL" />
  	<result column="game_validamount" property="gameValidamount" jdbcType="DECIMAL" />
  	<result column="game_calc_validamount" property="gameCalcValidamount" jdbcType="DECIMAL" />
  	<result column="game_uncalc_validamount" property="gameUncalcValidamount" jdbcType="DECIMAL" />
  	<result column="game_water" property="gameWater" jdbcType="DECIMAL" />
  	<result column="lotto_validamount" property="lottoValidamount" jdbcType="DECIMAL" />
  	<result column="lotto_calc_validamount" property="lottoCalcValidamount" jdbcType="DECIMAL" />
  	<result column="lotto_uncalc_validamount" property="lottoUncalcValidamount" jdbcType="DECIMAL" />
  	<result column="lotto_water" property="lottoWater" jdbcType="DECIMAL" />
  	<result column="hongkong_validamount" property="hongkongValidamount" jdbcType="DECIMAL" />
  	<result column="hongkong_calc_validamount" property="hongkongCalcValidamount" jdbcType="DECIMAL" />
  	<result column="hongkong_uncalc_validamount" property="hongkongUncalcValidamount" jdbcType="DECIMAL" />
  	<result column="hongkong_water" property="hongkongWater" jdbcType="DECIMAL" />
  	<result column="bb_sport_validamount" property="bbSportValidamount" jdbcType="DECIMAL" />
  	<result column="bb_sport_calc_validamount" property="bbSportCalcValidamount" jdbcType="DECIMAL" />
  	<result column="bb_sport_uncalc_validamount" property="bbSportUncalcValidamount" jdbcType="DECIMAL" />
  	<result column="bb_sport_water" property="bbSportWater" jdbcType="DECIMAL" />
  	<result column="bb_3d_validamount" property="bb3dValidamount" jdbcType="DECIMAL" />
  	<result column="bb_3d_calc_validamount" property="bb3dCalcValidamount" jdbcType="DECIMAL" />
  	<result column="bb_3d_uncalc_validamount" property="bb3dUncalcValidamount" jdbcType="DECIMAL" />
  	<result column="bb_3d_water" property="bb3dWater" jdbcType="DECIMAL" />
  </resultMap>
  <resultMap id="ValidUserMap" type="com.ds.report.entity.DsCommissionTotal" >
  	<result column="record_count" property="recordCount" jdbcType="INTEGER" />
    <result column="agents" property="agents" jdbcType="VARCHAR" />
    <result column="user_count" property="userCount" jdbcType="INTEGER" />
  </resultMap>
 <parameterMap id="waterReportParameterMap" type="map">  
   <parameter property="condition" jdbcType="VARCHAR" mode="IN"/>  
   <parameter property="returnOrder" jdbcType="VARCHAR" mode="IN"/>  
   <parameter property="returnPercent" jdbcType="VARCHAR" mode="IN"/>  
 </parameterMap> 
 <parameterMap id="validUserParameterMap" type="map">  
   <parameter property="condition" jdbcType="VARCHAR" mode="IN"/>  
   <parameter property="recordCount" jdbcType="INTEGER" mode="OUT"/>  
   <parameter property="userCount" jdbcType="INTEGER" mode="OUT"/>  
 </parameterMap> 
 <parameterMap id="waterNewPageMap" type="map">
 	<parameter property="condition" jdbcType="VARCHAR" mode="IN"/>
 	<parameter property="startIndex" jdbcType="INTEGER" mode="IN"/>
 	<parameter property="recordCount" jdbcType="INTEGER" mode="IN"/>
 	<parameter property="totalCount" jdbcType="INTEGER" mode="OUT"/>
 </parameterMap>
 <parameterMap id="commissionTotalByPageMap" type="map">
 	<parameter property="condition" jdbcType="VARCHAR" mode="IN"/>
 	<parameter property="startIndex" jdbcType="INTEGER" mode="IN"/>
 	<parameter property="recordCount" jdbcType="INTEGER" mode="IN"/>
 	<parameter property="totalCount" jdbcType="INTEGER" mode="OUT"/>
 </parameterMap>
  <select id="waterReportByProc" parameterMap="waterReportParameterMap" statementType="CALLABLE" resultMap="WaterTotalMap" >
   		{call sp_water_report(?,?,?)}  
  </select>
  <select id="waterReportTotal" parameterType="java.lang.String" statementType="CALLABLE" resultMap="WaterTotalMap" >
  		{call sp_water_report_total(#{condition,jdbcType=VARCHAR,mode=IN})}
  </select>
  <select id="waterReportTotalNew" parameterType="java.lang.String" statementType="CALLABLE" resultType="com.ds.report.entity.DsWaterTotalNew" >
  		{call sp_water_report_total_new(#{condition,jdbcType=VARCHAR,mode=IN})}
  </select>
  <select id="waterReportTotalNewByPage" parameterMap="waterNewPageMap" statementType="CALLABLE" resultType="com.ds.report.entity.DsWaterTotalNew" >
  		{call sp_water_report_total_new_copy(?,?,?,?)}
  </select>
  <select id="validUserListByProc" parameterType="java.lang.String" statementType="CALLABLE" resultMap="ValidUserMap,ValidUserMap" >
  		{call sp_validuser_total(#{condition,jdbcType=VARCHAR,mode=IN})}
  </select>
  <!-- ByPage -->
  <select id="commissionTotalByPage" parameterMap="commissionTotalByPageMap" statementType="CALLABLE" resultType="com.ds.report.entity.DsCommissionTotal" >
  		{call sp_commission_total_new_page(?,?,?,?)}
  </select>
  <select id="commissionTotalByProc" parameterType="java.lang.String" statementType="CALLABLE" resultMap="CommissionTotalMap" >
  		{call sp_commission_total_new(#{condition,jdbcType=VARCHAR,mode=IN})}
  </select>
  <select id="commissionTotal" parameterType="com.ds.report.entity.DsReportExample" resultMap="CommissionTotalMap" >
    SELECT a.agents,sum(case when a.validamount >= ${defValidamount} then 1 else 0 end ) as user_count, sum(a.winlose) as winlose,sum(a.validamount) as validamount 
      FROM (SELECT agents,username,sum(winlose) as winlose,sum(validamount) as validamount 
              FROM ds_report             
			<if test="_parameter != null" >
	  			<include refid="Example_Where_Clause" />
			</if>
	    	GROUP BY agents,username) a
	GROUP BY a.agents
  </select>
  <select id="validUserTotal" parameterType="com.ds.report.entity.DsReportExample" resultMap="ValidUserMap" >
  select count(1) as record_count,sum(b.user_count) as user_count
    from (SELECT a.agents,sum(case when a.validamount >= ${defValidamount} then 1 else 0 end ) as user_count
      FROM (SELECT agents,username,sum(validamount) as validamount 
              FROM ds_report             
			<if test="_parameter != null" >
	  			<include refid="Example_Where_Clause" />
			</if>
	    	GROUP BY agents,username) a
	  group by a.agents) b
  </select>
   <select id="validUserList" parameterType="com.ds.report.entity.DsReportExample" resultMap="ValidUserMap" >
    SELECT agents,sum(case when a.validamount >= ${defValidamount} then 1 else 0 end ) as user_count
      FROM (SELECT agents,username,sum(validamount) as validamount 
              FROM ds_report             
			<if test="_parameter != null" >
	  			<include refid="Example_Where_Clause" />
			</if>
	    	GROUP BY agents,username) a
	   GROUP BY a.agents
	<if test="page != null and pageLimit !=null">
      limit ${page},${pageLimit}
    </if>
  </select>
  <select id="waterReport" parameterType="com.ds.report.entity.DsReportExample" resultMap="WaterTotalMap" >
	  select agents,username,sum(validamount) AS total_validamount,0 AS total_water,0 AS return_water,0 as total_calc_validamount,sum(validamount) AS total_uncalc_validamount,
	        0 AS ball_validamount,0 AS ball_water,0 as ball_calc_validamount,0 as ball_uncalc_validamount,
	        sum(case when game_kind IN (3,21,41) then validamount else 0 end) AS live_validamount,0 AS live_water,
    		sum(case when game_kind = 3 then validamount else 0 end) AS live_bb_validamount,0 as live_bb_water,0 as live_bb_calc_validamount,sum(case when game_kind = 3 then validamount else 0 end) AS live_bb_uncalc_validamount,
    		sum(case when game_kind = 41 then validamount else 0 end) AS live_ds_validamount,0 as live_ds_water,0 as live_ds_calc_validamount,sum(case when game_kind = 41 then validamount else 0 end) AS live_ds_uncalc_validamount,
    		sum(case when game_kind = 21 then validamount else 0 end) AS live_other_validamount,0 as live_other_water,0 as live_other_calc_validamount,sum(case when game_kind = 21 then validamount else 0 end) AS live_other_uncalc_validamount,
    		sum(case when game_kind IN(5,22) then validamount else 0 end) AS game_validamount,0 AS game_water,0 as game_calc_validamount,sum(case when game_kind IN(5,22) then validamount else 0 end) AS game_uncalc_validamount,
    		0 AS lotto_validamount,0 AS lotto_water,0 as lotto_calc_validamount,0 as lotto_uncalc_validamount,
    		0 AS hongkong_validamount,0 AS hongkong_water,0 as hongkong_calc_validamount,0 as hongkong_uncalc_validamount,
    		sum(case when game_kind = 1 then validamount else 0 end) AS bb_sport_validamount,0 AS bb_sport_water,0 as bb_sport_calc_validamount,sum(case when game_kind = 1 then validamount else 0 end) AS bb_sport_uncalc_validamount,
    		sum(case when game_kind = 15 then validamount else 0 end) AS bb_3d_validamount,0 AS bb_3d_water,0 as bb_3d_calc_validamount,sum(case when game_kind = 15 then validamount else 0 end) AS bb_3d_uncalc_validamount
    	from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	   group by agents,username
  </select>
   <select id="auditTotal" parameterType="com.ds.report.entity.DsReportExample" resultMap="AuditTotalMap" >
	    select username,
	    	   sum(validamount) as total_validamount,
	           sum(case when game_kind in(1,42) then validamount else 0 end) as sport_validamount,
	           sum(case when game_kind in (3,21,41) then validamount else 0 end) as live_validamount,
	    	   sum(case when game_kind in (5,15,22,53) then validamount else 0 end) as jilv_validamount,
	           sum(case when game_kind in (12,51,52,54,55,57,58,59) then validamount else 0 end) as lotto_validamount
	      from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by username
  </select>
  <select id="privilegeTotalByProc" parameterType="java.lang.String" statementType="CALLABLE" resultMap="PrivilegeTotalMap" >
  	{call sp_privilege_total(#{condition,jdbcType=VARCHAR,mode=IN})}
  </select>
  <select id="privilegeTotal" parameterType="com.ds.report.entity.DsReportExample" resultMap="PrivilegeTotalMap" >
    <if test="agentLevel=='superior'.toString()" >
	    select Superior as username,
	           SUM(case when game_kind=1 then validamount else 0 end) AS bb_sport_validamount,
	           SUM(case when game_kind=3 then validamount else 0 end) AS bb_live_validamount,
	    	   SUM(case when game_kind=5 then validamount else 0 end) AS bb_jilv_validamount,
	           SUM(case when game_kind=15 then validamount else 0 end) AS bb_3d_validamount,
	           SUM(case when game_kind=21 then validamount else 0 end) AS ag_live_validamount,
	           SUM(case when game_kind=22 then validamount else 0 end) AS ag_jilv_validamount,
	           SUM(case when game_kind=41 then validamount else 0 end) AS ds_live_validamount
	      from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by Superior
    </if>
    <if test="agentLevel=='corprator'.toString()" >
	    select corprator as username,
	           SUM(case when game_kind=1 then validamount else 0 end) AS bb_sport_validamount,
	           SUM(case when game_kind=3 then validamount else 0 end) AS bb_live_validamount,
	    	   SUM(case when game_kind=5 then validamount else 0 end) AS bb_jilv_validamount,
	           SUM(case when game_kind=15 then validamount else 0 end) AS bb_3d_validamount,
	           SUM(case when game_kind=21 then validamount else 0 end) AS ag_live_validamount,
	           SUM(case when game_kind=22 then validamount else 0 end) AS ag_jilv_validamount,
	           SUM(case when game_kind=41 then validamount else 0 end) AS ds_live_validamount
	      from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by corprator
    </if>
    <if test="agentLevel=='world'.toString()" >
	    select world as username,
	           SUM(case when game_kind=1 then validamount else 0 end) AS bb_sport_validamount,
	           SUM(case when game_kind=3 then validamount else 0 end) AS bb_live_validamount,
	    	   SUM(case when game_kind=5 then validamount else 0 end) AS bb_jilv_validamount,
	           SUM(case when game_kind=15 then validamount else 0 end) AS bb_3d_validamount,
	           SUM(case when game_kind=21 then validamount else 0 end) AS ag_live_validamount,
	           SUM(case when game_kind=22 then validamount else 0 end) AS ag_jilv_validamount,
	           SUM(case when game_kind=41 then validamount else 0 end) AS ds_live_validamount
	      from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by world
    </if>
    <if test="agentLevel=='agent'.toString()" >
	    select agents as username,
	           SUM(case when game_kind=1 then validamount else 0 end) AS bb_sport_validamount,
	           SUM(case when game_kind=3 then validamount else 0 end) AS bb_live_validamount,
	    	   SUM(case when game_kind=5 then validamount else 0 end) AS bb_jilv_validamount,
	           SUM(case when game_kind=15 then validamount else 0 end) AS bb_3d_validamount,
	           SUM(case when game_kind=21 then validamount else 0 end) AS ag_live_validamount,
	           SUM(case when game_kind=22 then validamount else 0 end) AS ag_jilv_validamount,
	           SUM(case when game_kind=41 then validamount else 0 end) AS ds_live_validamount
	      from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by agents
    </if>
    <if test="agentLevel=='member'.toString()" >
	    select username,
	           SUM(case when game_kind=1 then validamount else 0 end) AS bb_sport_validamount,
	           SUM(case when game_kind=3 then validamount else 0 end) AS bb_live_validamount,
	    	   SUM(case when game_kind=5 then validamount else 0 end) AS bb_jilv_validamount,
	           SUM(case when game_kind=15 then validamount else 0 end) AS bb_3d_validamount,
	           SUM(case when game_kind=21 then validamount else 0 end) AS ag_live_validamount,
	           SUM(case when game_kind=22 then validamount else 0 end) AS ag_jilv_validamount,
	           SUM(case when game_kind=41 then validamount else 0 end) AS ds_live_validamount
	      from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by username
    </if>
  </select>
  <select id="queryTotalByProc" parameterType="java.lang.String" statementType="CALLABLE" resultMap="ReportResultMap" >
  	{call sp_total_report(#{condition,jdbcType=VARCHAR,mode=IN})}
  </select>
  <select id="queryTotal" parameterType="com.ds.report.entity.DsReportExample" resultMap="ReportResultMap" >
    <if test="agentLevel=='branch'.toString() or agentLevel=='' or agentLevel==null">
	    select a.* from ( 
	  	<if test="needTotal" >
		    select Superior as username,site_id, 0 as game_kind, '总计' as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
		          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
		          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
		    from ds_report
		    <if test="_parameter != null" >
		      <include refid="Example_Where_Clause" />
		    </if>
		    group by Superior,site_id
		    UNION ALL
	    </if>
		   select Superior as username,site_id, game_kind, max(game_kind_name) as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
		          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
		          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
		    from ds_report
		    <if test="_parameter != null" >
		      <include refid="Example_Where_Clause" />
		    </if>
		    group by Superior,site_id, game_kind) a
	    <if test="orderByClause != null" >
	      order by ${orderByClause}
	    </if>
    </if>
    
    <if test="agentLevel=='superior'.toString()" >
		select a.* from ( 
	  	<if test="needTotal" >
		    select Corprator as username,site_id, 0 as game_kind, '总计' as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
		          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
		          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
		    from ds_report
		    <if test="_parameter != null" >
		      <include refid="Example_Where_Clause" />
		    </if>
		    group by Corprator,site_id
		    UNION ALL
	    </if>
	    select Corprator as username,site_id, game_kind, max(game_kind_name) as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
	          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
	          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
	    from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by Corprator,site_id,game_kind) a
	    <if test="orderByClause != null" >
	      order by ${orderByClause}
	    </if>
    </if>
    <if test="agentLevel=='corprator'.toString()" >
		 select a.* from ( 
	  	 <if test="needTotal" >
		   select World as username,site_id, 0 as game_kind, '总计' as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
		          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
		          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
		     from ds_report
		    <if test="_parameter != null" >
		      <include refid="Example_Where_Clause" />
		    </if>
		    group by World,site_id
		    UNION ALL
		  </if>
		    select World as username,site_id, game_kind, max(game_kind_name) as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
		          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
		          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
		    from ds_report
		    <if test="_parameter != null" >
		      <include refid="Example_Where_Clause" />
		    </if>
		    group by World,site_id,game_kind) a
	    <if test="orderByClause != null" >
	      order by ${orderByClause}
	    </if>
    </if>
    <if test="agentLevel=='world'.toString()" >
		select a.* from ( 
	  	<if test="needTotal" >
		   select agents as username,site_id, 0 as game_kind, '总计' as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
		          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
		          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
		    from ds_report
		    <if test="_parameter != null" >
		      <include refid="Example_Where_Clause" />
		    </if>
		    group by agents,site_id
		    UNION ALL
		</if>    
		    select agents as username,site_id, game_kind, max(game_kind_name) as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
		          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
		          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
		    from ds_report
		    <if test="_parameter != null" >
		      <include refid="Example_Where_Clause" />
		    </if>
		    group by agents,site_id, game_kind)a
	    <if test="orderByClause != null" >
	      order by ${orderByClause}
	    </if>
    </if>
    <if test="agentLevel=='agent'.toString()" >
		select a.* from ( 
	  	<if test="needTotal" >
		  	select username,site_id, 0 as game_kind, '总计' as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
		          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
		          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
		    from ds_report
		    <if test="_parameter != null" >
		      <include refid="Example_Where_Clause" />
		    </if>
		    group by username,site_id
		    UNION ALL
		</if>   
		    select username,site_id, game_kind, max(game_kind_name) as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
		          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
		          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
		    from ds_report
		    <if test="_parameter != null" >
		      <include refid="Example_Where_Clause" />
		    </if>
		    group by username,site_id, game_kind)a
	    <if test="orderByClause != null" >
	      order by ${orderByClause}
	    </if>
    </if>
  </select>
  <select id="queryBetTotal" parameterType="com.ds.report.entity.DsReportExample" resultMap="BetTotalMap" >
    select game_type,max(game_name) as game_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount
      from ds_report
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    group by game_type
  </select>
  <select id="queryBetTotalByDay" parameterType="com.ds.report.entity.DsReportExample" resultMap="BetTotalMap" >
    select DATE_FORMAT(bet_time,'%Y-%m-%d') as bet_time,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount
      from ds_report
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
     group by DATE_FORMAT(bet_time,'%Y-%m-%d')
     <if test="orderType != null" >
	      order by bet_time ${orderType}
	 </if>
  </select>
  <!-- 增加查询 -->
  <select id="queryTotalByBranch" parameterType="com.ds.report.entity.DsReportExample" resultMap="ReportResultMap" >
  	select a.* from ( 
  	<if test="needTotal" >
	    select Superior as username,site_id, 0 as game_kind, '总计' as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
	          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
	          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
	    from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by Superior,site_id
	    UNION ALL
    </if>
	   select Superior as username,site_id, game_kind, max(game_kind_name) as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
	          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
	          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
	    from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by Superior,site_id, game_kind) a
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="queryTotalBySuperior" parameterType="com.ds.report.entity.DsReportExample" resultMap="ReportResultMap" >
    select a.* from ( 
  	<if test="needTotal" >
	    select Corprator as username,site_id, 0 as game_kind, '总计' as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
	          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
	          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
	    from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by Corprator,site_id
	    UNION ALL
    </if>
    select Corprator as username,site_id, game_kind, max(game_kind_name) as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
    from ds_report
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    group by Corprator,site_id,game_kind) a
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="queryTotalByCorprator" parameterType="com.ds.report.entity.DsReportExample" resultMap="ReportResultMap" >
     select a.* from ( 
  	 <if test="needTotal" >
	   select World as username,site_id, 0 as game_kind, '总计' as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
	          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
	          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
	     from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by World,site_id
	    UNION ALL
	  </if>
	    select World as username,site_id, game_kind, max(game_kind_name) as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
	          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
	          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
	    from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by World,site_id,game_kind) a
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="queryTotalByWorld" parameterType="com.ds.report.entity.DsReportExample" resultMap="ReportResultMap" >
    select a.* from ( 
  	<if test="needTotal" >
	   select agents as username,site_id, 0 as game_kind, '总计' as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
	          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
	          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
	    from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by agents,site_id
	    UNION ALL
	</if>    
	    select agents as username,site_id, game_kind, max(game_kind_name) as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
	          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
	          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
	    from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by agents,site_id, game_kind)a
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="queryTotalByAgent" parameterType="com.ds.report.entity.DsReportExample" resultMap="ReportResultMap" >
    select a.* from ( 
  	<if test="needTotal" >
	  	select username,site_id, 0 as game_kind, '总计' as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
	          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
	          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
	    from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by username,site_id
	    UNION ALL
	</if>   
	    select username,site_id, game_kind, max(game_kind_name) as game_kind_name,sum(bet_count) AS bet_count, SUM(betamount) AS betamount, SUM(winlose) AS winlose,SUM(validamount) AS validamount, 
	          max(agents) as agents,max(world) as world,max(corprator) as corprator,max(superior) as superior,
	          SUM(comm_agent) AS comm_agent,SUM(comm_world)AS comm_world,SUM(comm_corprator) AS comm_corprator, SUM(comm_superior) comm_superior,SUM(comm_branch) comm_branch
	    from ds_report
	    <if test="_parameter != null" >
	      <include refid="Example_Where_Clause" />
	    </if>
	    group by username,site_id, game_kind)a
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
 
  <sql id="Example_Where_Clause" >
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    id, username, bet_count, betamount, winlose, validamount, site_id, live_id, live_name, 
    game_kind, game_kind_name, game_type, game_name, bet_time, agents, world, corprator, 
    superior, company, comm_agent, comm_world, comm_corprator, comm_superior, comm_branch
  </sql>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.ds.report.entity.DsReportExample" >
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from ds_report
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    select 
    <include refid="Base_Column_List" />
    from ds_report
    where id = #{id,jdbcType=BIGINT}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    delete from ds_report
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <delete id="deleteByExample" parameterType="com.ds.report.entity.DsReportExample" >
    delete from ds_report
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.ds.report.entity.DsReport" >
    <selectKey resultType="java.lang.Long" keyProperty="id" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into ds_report (username, bet_count, betamount, 
      winlose, validamount, site_id, 
      live_id, live_name, game_kind, 
      game_kind_name, game_type, game_name, 
      bet_time, agents, world, 
      corprator, superior, company, 
      comm_agent, comm_world, comm_corprator, 
      comm_superior, comm_branch)
    values (#{username,jdbcType=VARCHAR}, #{betCount,jdbcType=INTEGER}, #{betamount,jdbcType=DECIMAL}, 
      #{winlose,jdbcType=DECIMAL}, #{validamount,jdbcType=DECIMAL}, #{siteId,jdbcType=INTEGER}, 
      #{liveId,jdbcType=TINYINT}, #{liveName,jdbcType=VARCHAR}, #{gameKind,jdbcType=INTEGER}, 
      #{gameKindName,jdbcType=VARCHAR}, #{gameType,jdbcType=INTEGER}, #{gameName,jdbcType=VARCHAR}, 
      #{betTime,jdbcType=DATE}, #{agents,jdbcType=VARCHAR}, #{world,jdbcType=VARCHAR}, 
      #{corprator,jdbcType=VARCHAR}, #{superior,jdbcType=VARCHAR}, #{company,jdbcType=VARCHAR}, 
      #{commAgent,jdbcType=DECIMAL}, #{commWorld,jdbcType=DECIMAL}, #{commCorprator,jdbcType=DECIMAL}, 
      #{commSuperior,jdbcType=DECIMAL}, #{commBranch,jdbcType=DECIMAL})
  </insert>
  <insert id="insertSelective" parameterType="com.ds.report.entity.DsReport" >
    <selectKey resultType="java.lang.Long" keyProperty="id" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into ds_report
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="username != null" >
        username,
      </if>
      <if test="betCount != null" >
        bet_count,
      </if>
      <if test="betamount != null" >
        betamount,
      </if>
      <if test="winlose != null" >
        winlose,
      </if>
      <if test="validamount != null" >
        validamount,
      </if>
      <if test="siteId != null" >
        site_id,
      </if>
      <if test="liveId != null" >
        live_id,
      </if>
      <if test="liveName != null" >
        live_name,
      </if>
      <if test="gameKind != null" >
        game_kind,
      </if>
      <if test="gameKindName != null" >
        game_kind_name,
      </if>
      <if test="gameType != null" >
        game_type,
      </if>
      <if test="gameName != null" >
        game_name,
      </if>
      <if test="betTime != null" >
        bet_time,
      </if>
      <if test="agents != null" >
        agents,
      </if>
      <if test="world != null" >
        world,
      </if>
      <if test="corprator != null" >
        corprator,
      </if>
      <if test="superior != null" >
        superior,
      </if>
      <if test="company != null" >
        company,
      </if>
      <if test="commAgent != null" >
        comm_agent,
      </if>
      <if test="commWorld != null" >
        comm_world,
      </if>
      <if test="commCorprator != null" >
        comm_corprator,
      </if>
      <if test="commSuperior != null" >
        comm_superior,
      </if>
      <if test="commBranch != null" >
        comm_branch,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="username != null" >
        #{username,jdbcType=VARCHAR},
      </if>
      <if test="betCount != null" >
        #{betCount,jdbcType=INTEGER},
      </if>
      <if test="betamount != null" >
        #{betamount,jdbcType=DECIMAL},
      </if>
      <if test="winlose != null" >
        #{winlose,jdbcType=DECIMAL},
      </if>
      <if test="validamount != null" >
        #{validamount,jdbcType=DECIMAL},
      </if>
      <if test="siteId != null" >
        #{siteId,jdbcType=INTEGER},
      </if>
      <if test="liveId != null" >
        #{liveId,jdbcType=TINYINT},
      </if>
      <if test="liveName != null" >
        #{liveName,jdbcType=VARCHAR},
      </if>
      <if test="gameKind != null" >
        #{gameKind,jdbcType=INTEGER},
      </if>
      <if test="gameKindName != null" >
        #{gameKindName,jdbcType=VARCHAR},
      </if>
      <if test="gameType != null" >
        #{gameType,jdbcType=INTEGER},
      </if>
      <if test="gameName != null" >
        #{gameName,jdbcType=VARCHAR},
      </if>
      <if test="betTime != null" >
        #{betTime,jdbcType=DATE},
      </if>
      <if test="agents != null" >
        #{agents,jdbcType=VARCHAR},
      </if>
      <if test="world != null" >
        #{world,jdbcType=VARCHAR},
      </if>
      <if test="corprator != null" >
        #{corprator,jdbcType=VARCHAR},
      </if>
      <if test="superior != null" >
        #{superior,jdbcType=VARCHAR},
      </if>
      <if test="company != null" >
        #{company,jdbcType=VARCHAR},
      </if>
      <if test="commAgent != null" >
        #{commAgent,jdbcType=DECIMAL},
      </if>
      <if test="commWorld != null" >
        #{commWorld,jdbcType=DECIMAL},
      </if>
      <if test="commCorprator != null" >
        #{commCorprator,jdbcType=DECIMAL},
      </if>
      <if test="commSuperior != null" >
        #{commSuperior,jdbcType=DECIMAL},
      </if>
      <if test="commBranch != null" >
        #{commBranch,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.ds.report.entity.DsReportExample" resultType="java.lang.Integer" >
    select count(*) from ds_report
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    update ds_report
    <set >
      <if test="record.id != null" >
        id = #{record.id,jdbcType=BIGINT},
      </if>
      <if test="record.username != null" >
        username = #{record.username,jdbcType=VARCHAR},
      </if>
      <if test="record.betCount != null" >
        bet_count = #{record.betCount,jdbcType=INTEGER},
      </if>
      <if test="record.betamount != null" >
        betamount = #{record.betamount,jdbcType=DECIMAL},
      </if>
      <if test="record.winlose != null" >
        winlose = #{record.winlose,jdbcType=DECIMAL},
      </if>
      <if test="record.validamount != null" >
        validamount = #{record.validamount,jdbcType=DECIMAL},
      </if>
      <if test="record.siteId != null" >
        site_id = #{record.siteId,jdbcType=INTEGER},
      </if>
      <if test="record.liveId != null" >
        live_id = #{record.liveId,jdbcType=TINYINT},
      </if>
      <if test="record.liveName != null" >
        live_name = #{record.liveName,jdbcType=VARCHAR},
      </if>
      <if test="record.gameKind != null" >
        game_kind = #{record.gameKind,jdbcType=INTEGER},
      </if>
      <if test="record.gameKindName != null" >
        game_kind_name = #{record.gameKindName,jdbcType=VARCHAR},
      </if>
      <if test="record.gameType != null" >
        game_type = #{record.gameType,jdbcType=INTEGER},
      </if>
      <if test="record.gameName != null" >
        game_name = #{record.gameName,jdbcType=VARCHAR},
      </if>
      <if test="record.betTime != null" >
        bet_time = #{record.betTime,jdbcType=DATE},
      </if>
      <if test="record.agents != null" >
        agents = #{record.agents,jdbcType=VARCHAR},
      </if>
      <if test="record.world != null" >
        world = #{record.world,jdbcType=VARCHAR},
      </if>
      <if test="record.corprator != null" >
        corprator = #{record.corprator,jdbcType=VARCHAR},
      </if>
      <if test="record.superior != null" >
        superior = #{record.superior,jdbcType=VARCHAR},
      </if>
      <if test="record.company != null" >
        company = #{record.company,jdbcType=VARCHAR},
      </if>
      <if test="record.commAgent != null" >
        comm_agent = #{record.commAgent,jdbcType=DECIMAL},
      </if>
      <if test="record.commWorld != null" >
        comm_world = #{record.commWorld,jdbcType=DECIMAL},
      </if>
      <if test="record.commCorprator != null" >
        comm_corprator = #{record.commCorprator,jdbcType=DECIMAL},
      </if>
      <if test="record.commSuperior != null" >
        comm_superior = #{record.commSuperior,jdbcType=DECIMAL},
      </if>
      <if test="record.commBranch != null" >
        comm_branch = #{record.commBranch,jdbcType=DECIMAL},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    update ds_report
    set id = #{record.id,jdbcType=BIGINT},
      username = #{record.username,jdbcType=VARCHAR},
      bet_count = #{record.betCount,jdbcType=INTEGER},
      betamount = #{record.betamount,jdbcType=DECIMAL},
      winlose = #{record.winlose,jdbcType=DECIMAL},
      validamount = #{record.validamount,jdbcType=DECIMAL},
      site_id = #{record.siteId,jdbcType=INTEGER},
      live_id = #{record.liveId,jdbcType=TINYINT},
      live_name = #{record.liveName,jdbcType=VARCHAR},
      game_kind = #{record.gameKind,jdbcType=INTEGER},
      game_kind_name = #{record.gameKindName,jdbcType=VARCHAR},
      game_type = #{record.gameType,jdbcType=INTEGER},
      game_name = #{record.gameName,jdbcType=VARCHAR},
      bet_time = #{record.betTime,jdbcType=DATE},
      agents = #{record.agents,jdbcType=VARCHAR},
      world = #{record.world,jdbcType=VARCHAR},
      corprator = #{record.corprator,jdbcType=VARCHAR},
      superior = #{record.superior,jdbcType=VARCHAR},
      company = #{record.company,jdbcType=VARCHAR},
      comm_agent = #{record.commAgent,jdbcType=DECIMAL},
      comm_world = #{record.commWorld,jdbcType=DECIMAL},
      comm_corprator = #{record.commCorprator,jdbcType=DECIMAL},
      comm_superior = #{record.commSuperior,jdbcType=DECIMAL},
      comm_branch = #{record.commBranch,jdbcType=DECIMAL}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.ds.report.entity.DsReport" >
    update ds_report
    <set >
      <if test="username != null" >
        username = #{username,jdbcType=VARCHAR},
      </if>
      <if test="betCount != null" >
        bet_count = #{betCount,jdbcType=INTEGER},
      </if>
      <if test="betamount != null" >
        betamount = #{betamount,jdbcType=DECIMAL},
      </if>
      <if test="winlose != null" >
        winlose = #{winlose,jdbcType=DECIMAL},
      </if>
      <if test="validamount != null" >
        validamount = #{validamount,jdbcType=DECIMAL},
      </if>
      <if test="siteId != null" >
        site_id = #{siteId,jdbcType=INTEGER},
      </if>
      <if test="liveId != null" >
        live_id = #{liveId,jdbcType=TINYINT},
      </if>
      <if test="liveName != null" >
        live_name = #{liveName,jdbcType=VARCHAR},
      </if>
      <if test="gameKind != null" >
        game_kind = #{gameKind,jdbcType=INTEGER},
      </if>
      <if test="gameKindName != null" >
        game_kind_name = #{gameKindName,jdbcType=VARCHAR},
      </if>
      <if test="gameType != null" >
        game_type = #{gameType,jdbcType=INTEGER},
      </if>
      <if test="gameName != null" >
        game_name = #{gameName,jdbcType=VARCHAR},
      </if>
      <if test="betTime != null" >
        bet_time = #{betTime,jdbcType=DATE},
      </if>
      <if test="agents != null" >
        agents = #{agents,jdbcType=VARCHAR},
      </if>
      <if test="world != null" >
        world = #{world,jdbcType=VARCHAR},
      </if>
      <if test="corprator != null" >
        corprator = #{corprator,jdbcType=VARCHAR},
      </if>
      <if test="superior != null" >
        superior = #{superior,jdbcType=VARCHAR},
      </if>
      <if test="company != null" >
        company = #{company,jdbcType=VARCHAR},
      </if>
      <if test="commAgent != null" >
        comm_agent = #{commAgent,jdbcType=DECIMAL},
      </if>
      <if test="commWorld != null" >
        comm_world = #{commWorld,jdbcType=DECIMAL},
      </if>
      <if test="commCorprator != null" >
        comm_corprator = #{commCorprator,jdbcType=DECIMAL},
      </if>
      <if test="commSuperior != null" >
        comm_superior = #{commSuperior,jdbcType=DECIMAL},
      </if>
      <if test="commBranch != null" >
        comm_branch = #{commBranch,jdbcType=DECIMAL},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.ds.report.entity.DsReport" >
    update ds_report
    set username = #{username,jdbcType=VARCHAR},
      bet_count = #{betCount,jdbcType=INTEGER},
      betamount = #{betamount,jdbcType=DECIMAL},
      winlose = #{winlose,jdbcType=DECIMAL},
      validamount = #{validamount,jdbcType=DECIMAL},
      site_id = #{siteId,jdbcType=INTEGER},
      live_id = #{liveId,jdbcType=TINYINT},
      live_name = #{liveName,jdbcType=VARCHAR},
      game_kind = #{gameKind,jdbcType=INTEGER},
      game_kind_name = #{gameKindName,jdbcType=VARCHAR},
      game_type = #{gameType,jdbcType=INTEGER},
      game_name = #{gameName,jdbcType=VARCHAR},
      bet_time = #{betTime,jdbcType=DATE},
      agents = #{agents,jdbcType=VARCHAR},
      world = #{world,jdbcType=VARCHAR},
      corprator = #{corprator,jdbcType=VARCHAR},
      superior = #{superior,jdbcType=VARCHAR},
      company = #{company,jdbcType=VARCHAR},
      comm_agent = #{commAgent,jdbcType=DECIMAL},
      comm_world = #{commWorld,jdbcType=DECIMAL},
      comm_corprator = #{commCorprator,jdbcType=DECIMAL},
      comm_superior = #{commSuperior,jdbcType=DECIMAL},
      comm_branch = #{commBranch,jdbcType=DECIMAL}
    where id = #{id,jdbcType=BIGINT}
  </update>
   <!-- 按game_type分组查询统计 -->
  <select id="getReportGroupByGameType" parameterType="com.ds.report.entity.DsReportExample" resultType="java.util.Map" >

    select a.username as username,SUM(a.bet_count) as betCount,sum(a.betamount) as betamount,sum(a.winlose) as winlose,sum(a.validamount) as validamount,
	a.game_kind as gameKind,a.game_kind_name as gameKindName,a.game_type as gameType,a.game_name as gameName
	from ds_report a
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    group by game_type limit ${page},${pageLimit}
  </select>
  
  <select id="getReportGroupByGameTypeCount" parameterType="com.ds.report.entity.DsReportExample" resultType="java.lang.Integer" >

    select count(t.id) from(select a.id from ds_report a
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    group by game_type) t
  </select>
  <!-- 查询用户下注过的gameKind -->
  <select id="getGameKindsByUsername" parameterType="java.util.HashMap" resultType="java.util.HashMap">
  	select a.game_kind as gameKind,a.game_kind_name as gameKindName,a.game_type as gameType,a.game_name as gameName
  	from ds_report a where a.username=#{username} and a.site_id=#{siteId}
  	and a.bet_time>=#{startTime} and a.bet_time&lt;=#{endTime} 
  	group by a.game_kind,a.game_type
  </select>
  <!-- 查询报表明细配置SQL -->
  <select id="getDetailSqlMap" resultType="java.util.HashMap" >
    select gameKind,select_sql
	from c_report_detail_config
	where state=50
  </select>
  <select id="getDetailDataBySql" parameterType="java.lang.String" resultType="java.util.HashMap">
  	${select_sql}
  </select>
  <select id="getGameWaterDataBySql" parameterType="java.lang.String" resultType="java.util.HashMap">
  	${select_sql}
  </select>
  
</mapper>